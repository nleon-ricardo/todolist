# Todo list lightweight REST API 

## Todo List App
 
### How to deploy 
 
Clone the repo, check-out the master branch.

* Build the app using maven

```bash
mvn clean package
```

* Build docker image
 
```bash
docker build -t <docker_image_name> .
```

* Run containerized docker app (run on container's port *port2*, expose on host's port number *port1*)
 
```bash
docker run -p <port1>:<port2> <docker_image_name>
```

* The API can be accessed through the following URL (see documentation part below for more details)

```bash
http://localhost:<port1>/todolist/items
```

**Note:** At startup, the Todo list is initialized with 2 items: *do this* and *do that*. 

### Documentation 

The API documentation is exposed through the Swagger UI (doc generation from code), which is available at the following url

```
http://localhost:<port1>/swagger-ui.html
```

**On top of providing the API doc, the Swagger UI can also be used to** 
* **build and send requests to the APP**
* generate requests to be run in a CLI environment using the `curl` tool

**Note:** As stated in the documentation, JSON is the only available content type, both for request (POST/PUT) and replies.

## Design

I'm not an expert in REST APIs but I took some time to refresh and try to deepen my knowledge.
In this regard, I hadn't enough time to come up with an API fulfilling the level 3 of Richardson's maturity model. So the concept of HATEOAS is
not taken into consideration in this API, although I could probably have done it quite quickly using dedicated frameworks such 
as Spring HATEOAS.
The other levels should be fine though.


## Implementation

### Technical stack

I went for the following set of technos:
* Java 8 + maven as build tool.
* Spring + Spring MVC + Spring Boot: 
   * Helped me to keep focused on the main components of the API (controller, model, service).
   * By providing the machinery to detect all the API components and glue them together (e.g. servlet container, MVC framework)
* Junit + Spring Boot for unit tests.
* SLFJ + Logback for logs.
* Spring Boot Actuator for monitoring/management. 
* Swagger for the API documentation generation.
I came up with a simple package structure : `controller` / `service` / `model`, which should be self-explanatory.

### Logs

I used SLF4 + Logback and only manually instrumented the `TodoListRestController` class.

Plenty of other loggers from the different Spring framework classes can be activated to grab useful information
(such as the content of incoming requests and outgoing replies )by setting their logging level accordingly in 
the `logback.xml` file.

By default, as it is configured in the repo, the default logging level for all classes is `INFO` and all the log messages
with a level greater than or equal to `INFO` will show in the standard output of the containerzed app.

### Monitoring

Although I'm not really familiar with it yet, I've used Spring Boot's Actuator module which allows for application
monitoring and management, through the activation of a bunch of end points available via HTTP or JMX.

I haven't add enough time to go into this thoroughly, but the `application.properties` file is the place where to declare
which endpoints should be made available.

The list of all available endpoints can be obtained by targetting the following URL: `http://localhost:<port1>/actuator/`.

In particular, one interesting example is the `logger` enable which allows to change the logging level of any logger.
For instance, the following request will turn all loggers to the `DEBUG` level and make the app highly verbose:

```bash
curl -i -X POST -H 'Content-Type: application/json' -d '{"configuredLevel": "DEBUG"}' http://localhost:<port1>/actuator/loggers/ROOT
```

### Limitations 

I tried to keep things as simple as possible.

#### Persistence 

I did not implement a proper persistence layer. 
Meaning that the items of the Todo List are only kept in the memory of the server (simple `ArrayList` Java structure) and 
won't survive a server shutdown or restart. 
This is also why the `TodoListServiceImpl`, which should delegate to a proper Repository for persistence, is actually 
the one class in charge of emulating persistence instead.
 
#### Concurrency  
 
I didn't have time enough to start thinking of the concurrency issues.
However a first step would be to secure the `ArrayList` used for storing all Todo items in `TodoListServiceImpl`, by using 
a proper wrapper data structure such as a `SynchronizedList`.

#### Todo items identifiers

Id's are generated by `TodoListServiceImpl` upon new item creations and the underlying counter is reset
upon calls to the `deleteAllItems` method (DELETE /todolist/allitems request).
I did not took care of the corner case where the number of items created exceeds `Long.MAX_VALUE`. 

### Security and access control

I hadn't time to cover this topic.